<div class="header">
  <h2 class="title">Flight Search</h2>
</div>

<form (ngSubmit)="search()" #ngForm="ngForm">
  <div class="form-group">
    <label>From:</label>
    <input [(ngModel)]="from" name="from" city class="form-control" />
    <pre>{{ ngForm.form.controls["from"].errors | json }}</pre>
    <pre>{{ ngForm.form.controls["from"].validator | json }}</pre>
  </div>
  <div class="form-group">
    <label>To:</label>
    <input [(ngModel)]="to" name="to" city required class="form-control" />
    <pre>{{ ngForm.form.controls["to"].errors | json }}</pre>
  </div>

  <div class="form-group">
    @if (ngForm.form.valid) {
      <button class="btn btn-default" [disabled]="!ngForm.form.valid">
        Search
      </button>
    }
  </div>
</form>

<p>Aktuelle Suche nach: {{ to }}</p>

@if (flights().length > 0) {
  @for (f of flights(); track f.id) {
    <app-flight-card [flight]="f" [(selected)]="basket[f.id]" />
  }
}

@let message = message$ | async;
@if (message) {
  <p>{{ message }}</p>
}

@if (selectedFlight) {
  <div>
    <pre>{{ selectedFlight | json }}</pre>
  </div>

  <form (ngSubmit)="saveFlight()">
    <input [(ngModel)]="selectedFlight.id" name="id" class="form-control" />
    <input [(ngModel)]="selectedFlight.from" name="from" class="form-control" />
    <input [(ngModel)]="selectedFlight.to" name="to" class="form-control" />
    <input [(ngModel)]="selectedFlight.date" name="date" class="form-control" />
    <input
      [(ngModel)]="selectedFlight.delayed"
      name="delayed"
      class="form-control"
    />
    <button>Speichern</button>
  </form>
}
